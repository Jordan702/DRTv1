<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>sETH Mint Portal</title>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f5f6fa;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px;
  }
  h1 {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  img.logo {
    height: 50px;
  }
  form {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    width: 300px;
  }
  input, button {
    padding: 8px;
    font-size: 16px;
  }
  button {
    background-color: #4CAF50;
    color: white;
    border: none;
    cursor: pointer;
  }
  button:hover {
    background-color: #45a049;
  }
  #status {
    margin-top: 20px;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>
  <img src="../Logos/sETH Logo.png" alt="sETH Logo" class="logo">
  Mint sETH Tokens
</h1>

<form id="mintForm">
  <label>Recipient Address:</label>
  <input type="text" id="recipient" placeholder="0x..." required>

  <label>Amount (like 11000000000000):</label>
  <input type="text" id="amount" placeholder="Amount" required>

  <button type="submit">Mint</button>
</form>

<div id="status"></div>

<script>
document.getElementById("mintForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const recipient = document.getElementById("recipient").value.trim();
    const amountInput = document.getElementById("amount").value.trim();

    if (!recipient || !amountInput) {
        alert("Please fill in both fields!");
        return;
    }

    try {
        // Convert large number input to BigInt string
        const amount = BigInt(amountInput) * 10n ** 18n;
        console.log(`[Frontend] Minting ${amount} sETH to ${recipient}...`);

        const res = await axios.post("https://drtv1-backend.onrender.com/api/mint", {
            recipient,
            amount: amount.toString()
        });

        console.log("[Frontend] Backend response:", res.data);
        document.getElementById("status").innerText = `✅ Mint successful! TxHash: ${res.data.txHash}`;
    } catch (err) {
        console.error("[Frontend] Mint error:", err.response?.data || err.message);
        document.getElementById("status").innerText = `❌ Error: ${err.response?.data?.error || err.message}`;
    }
});
</script>

</body>
</html>
