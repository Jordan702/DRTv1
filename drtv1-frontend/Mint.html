<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DRTv1 Mint Portal</title>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f2f2f2;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding-top: 50px;
  }
  .container {
    background: white;
    padding: 30px 40px;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    text-align: center;
    max-width: 450px;
    width: 100%;
  }
  img.logo {
    width: 120px;
    margin-bottom: 20px;
  }
  h1 {
    font-size: 24px;
    margin-bottom: 25px;
    color: #222;
  }
  input[type="text"], input[type="number"] {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    margin-bottom: 15px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 16px;
  }
  button {
    background-color: #4CAF50;
    color: white;
    padding: 12px 25px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
  }
  button:hover {
    background-color: #45a049;
  }
  #status {
    margin-top: 20px;
    font-size: 14px;
    color: #333;
    word-break: break-word;
  }
</style>
</head>
<body>
<div class="container">
  <img src="../Logos/DRTv1.png" alt="DRTv1 Logo" class="logo">
  <h1>Mint DRTv1 Tokens</h1>

  <form id="mintForm">
    <label>Recipient Address:</label>
    <input type="text" id="recipient" required placeholder="0x..."><br>

    <label>Amount (use large numbers safely):</label>
    <input type="text" id="amount" required placeholder="11000000000000"><br>

    <button type="submit">Mint</button>
  </form>

  <div id="status"></div>
</div>

<script>
const statusDiv = document.getElementById("status");

document.getElementById("mintForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const recipient = document.getElementById("recipient").value.trim();
  const amountInput = document.getElementById("amount").value.trim();

  if (!recipient || !amountInput) {
    alert("Please fill in both fields!");
    return;
  }

  try {
    const amount = BigInt(amountInput) * 10n ** 18n;
    console.log(`[Mint] Preparing to mint ${amount} DRTv1 to ${recipient}...`);
    statusDiv.innerText = `⏳ Preparing mint for ${recipient}...`;

    const res = await axios.post("https://drtv1-backend.onrender.com/api/mint", {
      recipient,
      amount: amount.toString()
    });

    console.log("[Mint] Backend response:", res.data);
    statusDiv.innerText = `✅ Mint successful!\nTxHash: ${res.data.txHash}`;
  } catch (err) {
    console.error("[Mint] Error:", err.response?.data || err.message);
    statusDiv.innerText = `❌ Error: ${err.response?.data?.error || err.message}`;
  }
});
</script>
</body>
</html>
